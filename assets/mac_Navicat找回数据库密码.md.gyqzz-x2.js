import{_ as n,c as a,a2 as l,o as p}from"./chunks/framework.BPuE4Feg.js";const o="/assets/findkey.BnAkRICJ.png",A=JSON.parse('{"title":"Navicat 找回数据库密码","description":"","frontmatter":{},"headers":[],"relativePath":"mac/Navicat找回数据库密码.md","filePath":"mac/Navicat找回数据库密码.md"}'),e={name:"mac/Navicat找回数据库密码.md"};function t(r,s,c,B,y,i){return p(),a("div",null,s[0]||(s[0]=[l(`<h1 id="navicat-找回数据库密码" tabindex="-1">Navicat 找回数据库密码 <a class="header-anchor" href="#navicat-找回数据库密码" aria-label="Permalink to &quot;Navicat 找回数据库密码&quot;">​</a></h1><p>在线代码执行工具(在线运行 php,c,c++,go,python,java,groovy 代码)</p><p><a href="https://tool.lu/coderunner/" target="_blank" rel="noreferrer">https://tool.lu/coderunner/</a></p><p>导出密码后，打开ncx获取<code>Password</code>内容，写入代码倒数第二行</p><div class="language-php line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">decrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;833E4ABBC56C89041A9070F043641E3B&#39;</span><span style="color:#ABB2BF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="完整代码" tabindex="-1">完整代码 <a class="header-anchor" href="#完整代码" aria-label="Permalink to &quot;完整代码&quot;">​</a></h2><div class="language-php line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#56B6C2;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">php</span></span>
<span class="line"><span style="color:#C678DD;">namespace</span><span style="color:#E5C07B;"> FatSmallTools</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> NavicatPassword</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#E06C75;"> $version</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#E06C75;"> $aesKey</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;libcckeylibcckey&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#E06C75;"> $aesIv</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;libcciv libcciv &#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#E06C75;"> $blowString</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;3DC5CA39&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#E06C75;"> $blowKey</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#E06C75;"> $blowIv</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	public</span><span style="color:#C678DD;"> function</span><span style="color:#56B6C2;"> __construct</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$version</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 12</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E5C07B;">		$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">version</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> $version</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">		$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">blowKey</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> sha1</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;3DC5CA39&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">		$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">blowIv</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> hex2bin</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;d9c7c3c8870d64bd&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	public</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> encrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$result</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> FALSE</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		switch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			case</span><span style="color:#D19A66;"> 11</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">				$result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">encryptEleven</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			case</span><span style="color:#D19A66;"> 12</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">				$result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">encryptTwelve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			default</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> $result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> encryptEleven</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$round</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> intval</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">floor</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">strlen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">)</span><span style="color:#56B6C2;"> /</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#E06C75;">		$leftLength</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> strlen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">%</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		$result</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		$currentVector</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">blowIv</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">$i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">$i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> $round</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">$i</span><span style="color:#ABB2BF;">++) {</span></span>
<span class="line"><span style="color:#E06C75;">			$temp</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">encryptBlock</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">substr</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 8</span><span style="color:#56B6C2;"> *</span><span style="color:#E06C75;"> $i</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#E06C75;">			$currentVector</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">$temp</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">			$result</span><span style="color:#ABB2BF;"> .=</span><span style="color:#E06C75;"> $temp</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">$leftLength</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">			$currentVector</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">encryptBlock</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">			$result</span><span style="color:#ABB2BF;"> .=</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">substr</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 8</span><span style="color:#56B6C2;"> *</span><span style="color:#E06C75;"> $i</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> $leftLength</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#56B6C2;"> strtoupper</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">bin2hex</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$result</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> encryptBlock</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$block</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#56B6C2;"> openssl_encrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$block</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;"> &#39;BF-ECB&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">blowKey</span><span style="color:#ABB2BF;">,</span><span style="color:#ABB2BF;"> OPENSSL_RAW_DATA</span><span style="color:#56B6C2;">|</span><span style="color:#ABB2BF;">OPENSSL_NO_PADDING);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> decryptBlock</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$block</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#56B6C2;"> openssl_decrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$block</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;"> &#39;BF-ECB&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">blowKey</span><span style="color:#ABB2BF;">,</span><span style="color:#ABB2BF;"> OPENSSL_RAW_DATA</span><span style="color:#56B6C2;">|</span><span style="color:#ABB2BF;">OPENSSL_NO_PADDING);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$str1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">$str2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$result</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">$i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">$i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#56B6C2;"> strlen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$str1</span><span style="color:#ABB2BF;">); </span><span style="color:#E06C75;">$i</span><span style="color:#ABB2BF;">++) {</span></span>
<span class="line"><span style="color:#E06C75;">			$result</span><span style="color:#ABB2BF;"> .=</span><span style="color:#56B6C2;"> chr</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">ord</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$str1</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">$i</span><span style="color:#ABB2BF;">])</span><span style="color:#56B6C2;"> ^</span><span style="color:#56B6C2;"> ord</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$str2</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">$i</span><span style="color:#ABB2BF;">]));</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> $result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> encryptTwelve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$result</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> openssl_encrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;"> &#39;AES-128-CBC&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">aesKey</span><span style="color:#ABB2BF;">,</span><span style="color:#ABB2BF;"> OPENSSL_RAW_DATA,</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">aesIv</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#56B6C2;"> strtoupper</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">bin2hex</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$result</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	public</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> decrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$result</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> FALSE</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		switch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			case</span><span style="color:#D19A66;"> 11</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">				$result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">decryptEleven</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			case</span><span style="color:#D19A66;"> 12</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">				$result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">decryptTwelve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			default</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> $result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> decryptEleven</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$upperString</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$string</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> hex2bin</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">strtolower</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$upperString</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#E06C75;">		$round</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> intval</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">floor</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">strlen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">)</span><span style="color:#56B6C2;"> /</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#E06C75;">		$leftLength</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> strlen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">%</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		$result</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		$currentVector</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">blowIv</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">$i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">$i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> $round</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">$i</span><span style="color:#ABB2BF;">++) {</span></span>
<span class="line"><span style="color:#E06C75;">			$encryptedBlock</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> substr</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 8</span><span style="color:#56B6C2;"> *</span><span style="color:#E06C75;"> $i</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">			$temp</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">$this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">decryptBlock</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$encryptedBlock</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">			$currentVector</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">$encryptedBlock</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">			$result</span><span style="color:#ABB2BF;"> .=</span><span style="color:#E06C75;"> $temp</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">$leftLength</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">			$currentVector</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">encryptBlock</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">			$result</span><span style="color:#ABB2BF;"> .=</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">xorBytes</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">substr</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> 8</span><span style="color:#56B6C2;"> *</span><span style="color:#E06C75;"> $i</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> $leftLength</span><span style="color:#ABB2BF;">), </span><span style="color:#E06C75;">$currentVector</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> $result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	protected</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> decryptTwelve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$upperString</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		$string</span><span style="color:#56B6C2;"> =</span><span style="color:#56B6C2;"> hex2bin</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">strtolower</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$upperString</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#56B6C2;"> openssl_decrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$string</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;"> &#39;AES-128-CBC&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">aesKey</span><span style="color:#ABB2BF;">,</span><span style="color:#ABB2BF;"> OPENSSL_RAW_DATA,</span><span style="color:#E5C07B;"> $this</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">aesIv</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">use</span><span style="color:#ABB2BF;"> FatSmallTools\\</span><span style="color:#E5C07B;">NavicatPassword</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 需要指定版本，11或12</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// $navicatPassword = new NavicatPassword(11);</span></span>
<span class="line"><span style="color:#E06C75;">$navicatPassword</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> NavicatPassword</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 解密</span></span>
<span class="line"><span style="color:#E06C75;">$decode</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> $navicatPassword</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">decrypt</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;833E4ABBC56C89041A9070F043641E3B&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#56B6C2;">echo</span><span style="color:#E06C75;"> $decode</span><span style="color:#ABB2BF;">.</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br></div></div><h2 id="执行结果" tabindex="-1">执行结果 <a class="header-anchor" href="#执行结果" aria-label="Permalink to &quot;执行结果&quot;">​</a></h2><p><img src="`+o+'" alt="执行结果"></p>',9)]))}const F=n(e,[["render",t]]);export{A as __pageData,F as default};
