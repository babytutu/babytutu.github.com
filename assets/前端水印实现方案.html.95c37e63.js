import{_ as n,o as a,c as s,f as t}from"./app.c90e916d.js";var p="/assets/watermark.c745f847.png";const o={},e=t(`<h1 id="\u524D\u7AEF\u6C34\u5370\u5B9E\u73B0\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u524D\u7AEF\u6C34\u5370\u5B9E\u73B0\u65B9\u6848" aria-hidden="true">#</a> \u524D\u7AEF\u6C34\u5370\u5B9E\u73B0\u65B9\u6848</h1><h2 id="\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u539F\u7406" aria-hidden="true">#</a> \u539F\u7406</h2><ul><li>js\u65B9\u6CD5</li><li>\u914D\u7F6E\u6C34\u5370\u5185\u5BB9\uFF0C\u4E00\u822C\u4E3A\u767B\u5F55\u7CFB\u7EDF\u540E\u7684\u8D26\u53F7</li><li>\u914D\u7F6E\u662F\u5426\u5C55\u793A\u6C34\u5370\uFF0C\u4E00\u822C\u901A\u8FC7\u914D\u7F6E\u8DEF\u7531meta\u5B9E\u73B0</li></ul><h2 id="js\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#js\u65B9\u6CD5" aria-hidden="true">#</a> js\u65B9\u6CD5</h2><p>\u6C34\u5370\u529F\u80FD\u6A21\u5757\uFF0C\u4E00\u822C\u653E\u5728<code>src/utils</code>\u76EE\u5F55\u4E0B</p><details class="custom-container details"><summary>watermark.js</summary><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u524D\u7AEF\u6C34\u5370\u751F\u6210\u5DE5\u5177\u7C7B
 * \u652F\u6301\u81EA\u5B9A\u4E49\u6C34\u5370\u5185\u5BB9\u548C\u4F4D\u7F6E
 */</span>
<span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// \u6C34\u5370id</span>
<span class="token keyword">let</span> watermarkTimer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// \u6C34\u5370\u5B9A\u65F6\u5668</span>

<span class="token doc-comment comment">/**
 * \u5220\u9664\u6C34\u5370
 * \u8DEF\u7531\u5207\u6362\u65F6\uFF0C\u4ECE\u9700\u8981\u6C34\u5370\u9875\u9762\u5230\u4E0D\u9700\u6C34\u5370\u9875\u9762\uFF0C\u9700\u8981\u5220\u9664\u6C34\u5370\u5E76\u505C\u6B62\u5B58\u5728\u7684\u6C34\u5370\u5B9A\u65F6\u5668
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">removeWatermark</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  id <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
  watermarkTimer <span class="token operator">&amp;&amp;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>watermarkTimer<span class="token punctuation">)</span>
  watermarkTimer <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * \u751F\u6210\u6C34\u5370
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">text</span> \u6C34\u5370\u5185\u5BB9
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">top</span> \u8DDD\u79BB\u9876\u90E8\u4F4D\u7F6E
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">left</span> \u8DDD\u79BB\u5DE6\u4FA7\u4F4D\u7F6E
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> <span class="token parameter">width</span> \u7B7E\u540D\u5BBD\u5EA6
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> <span class="token parameter">height</span> \u7B7E\u540D\u9AD8\u5EA6
 * <span class="token keyword">@returns</span> \u8FD4\u56DE\u6C34\u5370id
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">setWatermarkDIV</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> top<span class="token punctuation">,</span> left<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">removeWatermark</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  id <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10000</span> <span class="token operator">+</span> <span class="token string">&#39;-&#39;</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10000</span> <span class="token operator">+</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10000</span>

  <span class="token keyword">const</span> can <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;canvas&#39;</span><span class="token punctuation">)</span>
  can<span class="token punctuation">.</span>width <span class="token operator">=</span> width
  can<span class="token punctuation">.</span>height <span class="token operator">=</span> height

  <span class="token keyword">const</span> cans <span class="token operator">=</span> can<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span>
  cans<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">20</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span>
  cans<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&#39;15px Vedana&#39;</span>
  cans<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;rgba(0, 0, 0, .2)&#39;</span>
  cans<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&#39;left&#39;</span>
  cans<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&#39;Middle&#39;</span>
  cans<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> can<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">,</span> can<span class="token punctuation">.</span>height<span class="token punctuation">)</span>

  <span class="token keyword">const</span> waterDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span>
  waterDiv<span class="token punctuation">.</span>id <span class="token operator">=</span> id
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span>
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&#39;url(&#39;</span> <span class="token operator">+</span> can<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#39;image/png&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;) left top repeat&#39;</span>
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">&#39;fixed&#39;</span>
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>zIndex <span class="token operator">=</span> <span class="token string">&#39;100000&#39;</span>
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">&#39;100%&#39;</span>
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">&#39;100%&#39;</span>
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> top
  waterDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> left
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>waterDiv<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * \u8BBE\u7F6E\u6C34\u5370\uFF0C\u5B9A\u65F6\u56682\u79D21\u6B21\uFF0C\u5220\u9664\u540E\u4ECD\u4F1A\u81EA\u52A8\u751F\u6210
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">text</span> \u6C34\u5370\u5185\u5BB9
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">top</span> \u8DDD\u79BB\u9876\u90E8\u4F4D\u7F6E\uFF0C\u9ED8\u8BA40px
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">left</span> \u8DDD\u79BB\u5DE6\u4FA7\u4F4D\u7F6E\uFF0C \u9ED8\u8BA40px
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> <span class="token parameter">width</span> \u7B7E\u540D\u5BBD\u5EA6\uFF0C\u9ED8\u8BA4200
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> <span class="token parameter">height</span> \u7B7E\u540D\u9AD8\u5EA6\uFF0C\u9ED8\u8BA4200
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> setWatermark <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">,</span> top <span class="token operator">=</span> <span class="token string">&#39;0px&#39;</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token string">&#39;0px&#39;</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setWatermarkDIV</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> top<span class="token punctuation">,</span> left<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
  watermarkTimer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setWatermarkDIV</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> top<span class="token punctuation">,</span> left<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></details><h2 id="\u914D\u7F6E\u6C34\u5370\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u6C34\u5370\u5185\u5BB9" aria-hidden="true">#</a> \u914D\u7F6E\u6C34\u5370\u5185\u5BB9</h2><p>\u767B\u5F55\u7CFB\u7EDF\u540E\uFF0C\u6839\u636E\u8D26\u53F7\u914D\u7F6E\u83B7\u53D6\u662F\u5426\u5C55\u793A\u6C34\u5370\uFF0C\u5982\u9700\u5C55\u793A\uFF0C\u5219\u7F13\u5B58\u4E2D\u65B0\u589E\u6C34\u5370\u5185\u5BB9\u4E3A\u8D26\u53F7\u4FE1\u606F</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&#39;watermark&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;\u8D26\u53F7\u4FE1\u606F\u793A\u4F8B&#39;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="\u914D\u7F6E\u6C34\u5370" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u6C34\u5370" aria-hidden="true">#</a> \u914D\u7F6E\u6C34\u5370</h2><p>\u8DEF\u7531\u4FE1\u606F<code>meta</code>\u4E2D\u589E\u52A0\u6C34\u5370\u53C2\u6570<code>watermark</code></p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token comment">// \u9700\u8981\u5C55\u793A\u6C34\u5370\u7684\u8DEF\u7531\u9875\u9762</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/watermark&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;demo&quot; */</span> <span class="token string">&#39;./watermark.vue&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;\u5C55\u793A\u6C34\u5370&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">watermark</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>\u5168\u5C40\u8DEF\u7531\u589E\u52A0\u5224\u65AD</p><p>main.js</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setWatermark<span class="token punctuation">,</span> removeWatermark <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/watermark&#39;</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> watermarkInfo <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;watermark&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>watermarkInfo <span class="token operator">&amp;&amp;</span> to<span class="token punctuation">.</span>meta <span class="token operator">&amp;&amp;</span> to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>watermark<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setWatermark</span><span class="token punctuation">(</span>watermarkInfo<span class="token punctuation">,</span> <span class="token string">&#39;-100px&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;150px&#39;</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">removeWatermark</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="\u6548\u679C\u5C55\u793A" tabindex="-1"><a class="header-anchor" href="#\u6548\u679C\u5C55\u793A" aria-hidden="true">#</a> \u6548\u679C\u5C55\u793A</h2><p><img src="`+p+'" alt="\u6C34\u5370\u5B9E\u73B0"></p>',17),c=[e];function l(u,k){return a(),s("div",null,c)}var i=n(o,[["render",l],["__file","\u524D\u7AEF\u6C34\u5370\u5B9E\u73B0\u65B9\u6848.html.vue"]]);export{i as default};
